{
  "name": "fortinet-fortiddos",
  "version": "1.0.0",
  "label": "Fortinet FortiDDoS",
  "description": "FortiDDoS Protection Solution defends enterprise data centers against DDoS attacks by leveraging an extensive collection of known DDoS methodologies, creating a multi-layered approach to mitigate attacks.  It also analyzes the behavior of data to detect new attacks, allowing it to stop zero-day threats.",
  "publisher": "Fortinet",
  "cs_approved": true,
  "cs_compatible": true,
  "icon_small_name": "fortiddos_32x32.png",
  "icon_large_name": "fortiddos_80x80.png",
  "category": "Network Security",
  "help_online": "https://docs.fortinet.com/document/fortisoar/1.0.0/fortinet-fortiddos/409/fortinet-fortiddos-v1-0-0",
  "configuration": {
    "fields": [
      {
        "title": "Server Address",
        "type": "text",
        "name": "server_address",
        "required": true,
        "visible": true,
        "editable": true,
        "description": "URL of the FortiDDoS appliance to which you will connect and perform automated operations."
      },
      {
        "title": "Username",
        "type": "text",
        "name": "username",
        "required": true,
        "visible": true,
        "editable": true,
        "description": "Username to access your FortiDDoS appliance to which you will connect and perform automated operations."
      },
      {
        "title": "Password",
        "type": "password",
        "name": "password",
        "required": true,
        "visible": true,
        "editable": true,
        "description": "Password to access your FortiDDoS appliance to which you will connect and perform automated operations."
      },
      {
        "title": "Verify SSL",
        "type": "checkbox",
        "name": "verify_ssl",
        "required": false,
        "visible": true,
        "editable": true,
        "value": true,
        "description": "Specifies whether the SSL certificate for the server is to be verified or not."
      }
    ]
  },
  "operations": [
    {
      "title": "Get Protection Profiles",
      "operation": "get_spp_settings",
      "description": "Retrieves the Protection Profiles details from the FortiDDoS appliance based on the Service Protection Profile (SPP) name and resource name you have specified.",
      "category": "investigation",
      "annotation": "get_spp_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "SPP Name",
          "type": "text",
          "name": "spp",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "SPP-0",
          "tooltip": "Name of the service protection profile",
          "description": "Specify the name of the Service Protection Profile (SPP) whose details you want to retrieve from FortiDDoS."
        },
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "SPP Settings",
          "options": [
            "SPP Settings",
            "Service Config",
            "Access Control List",
            "Address Config",
            "Address Config IPv6",
            "Extended Timeout Policy",
            "Thresholds > Thresholds > Scalars",
            "Thresholds > Thresholds > HTTP Methods",
            "Thresholds > Thresholds > Protocols",
            "Thresholds > Thresholds > TCP Ports",
            "Thresholds > Thresholds > UDP Ports",
            "Thresholds > Thresholds > ICMP Types/Codes",
            "Thresholds > Thresholds > URLs",
            "Thresholds > Thresholds > Hosts",
            "Thresholds > Thresholds > Referers",
            "Thresholds > Thresholds > Cookies",
            "Thresholds > Thresholds > User Agents"
          ],
          "description": "Select the name of the resource for which you want to retrieve information from FortiDDoS. You can choose the following options: SPP Settings, Service Config, Access Control List, Address Config, Address Config IPv6, Extended Timeout Policy, Thresholds > Thresholds > Scalars, Thresholds > Thresholds > HTTP Methods, Thresholds > Thresholds > Protocols, Thresholds > Thresholds > TCP Ports, Thresholds > Thresholds > UDP Ports, Thresholds > Thresholds > ICMP Types/Codes, Thresholds > Thresholds > URLs, Thresholds > Thresholds > Hosts, Thresholds > Thresholds > Referers, Thresholds > Thresholds > Cookies, Thresholds > Thresholds > User Agents."
        }
      ],
      "conditional_output_schema": [
        {
          "condition": "{{true}}",
          "output_schema": {
            "success": "",
            "query": "",
            "data": [],
            "message": ""
          }
        },
        {
          "condition": "{{this['resource_name'] === 'SPP Settings'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "spp-id": "",
                "adaptive-mode": "",
                "adaptive-limit": "",
                "strict-anomalies": "",
                "dns-authentication": "",
                "slow-connection-type": "",
                "duplicate-query-check": "",
                "ntp-request-threshold": "",
                "inbound-operating-mode": "",
                "ntp-response-threshold": "",
                "source-blocking-in-dns": "",
                "ntp-broadcast-threshold": "",
                "outbound-operating-mode": "",
                "tcp-session-idle-timeout": "",
                "syn-flood-mitigation-mode": "",
                "syn-with-payload-direction": "",
                "mandatory-http-header-count": "",
                "match-response-with-queries": "",
                "tcp-session-feature-control": "",
                "tcp-session-extended-timeout": "",
                "inbound-source-penalty-factor": "",
                "tcp-session-idle-timeout-unit": "",
                "force-tcp-or-forward-to-server": "",
                "ntp-response-per-dst-threshold": "",
                "outbound-source-penalty-factor": "",
                "syn-flood-mitigation-direction": "",
                "aggressive-aging-feature-control": "",
                "dns-data-anomaly-feature-control": "",
                "dns-info-anomaly-feature-control": "",
                "dns-flood-mitigation-mode-inbound": "",
                "dns-query-anomaly-feature-control": "",
                "ntp-mode-mismatch-feature-control": "",
                "ssl-renegotiation-feature-control": "",
                "tcp-session-extended-timeout-unit": "",
                "dns-flood-mitigation-mode-outbound": "",
                "dns-header-anomaly-feature-control": "",
                "inbound-application-penalty-factor": "",
                "ntp-retransmission-feature-control": "",
                "slow-tcp-connection-byte-threshold": "",
                "dns-exploit-anomaly-feature-control": "",
                "ntp-stratum-anomaly-feature-control": "",
                "ntp-version-anomaly-feature-control": "",
                "outbound-application-penalty-factor": "",
                "allow-only-valid-queries-under-flood": "",
                "dns-response-anomaly-feature-control": "",
                "ntp-sequence-mismatch-feature-control": "",
                "slow-tcp-connection-observation-period": "",
                "http-incomplete-request-feature-control": "",
                "ntp-data-length-anomaly-feature-control": "",
                "generate-response-from-cache-under-flood": "",
                "ntp-unsolicited-response-feature-control": "",
                "restrict-dns-queries-to-specific-subnets": "",
                "source-blocking-for-tcp-slow-connections": "",
                "validate-ttl-for-queries-from-the-same-ip": "",
                "dns-buffer-overflow-anomaly-feature-control": "",
                "ntp-control-header-anomalies-feature-control": "",
                "source-blocking-for-http-incomplete-requests": ""
              }
            ]
          }
        }
      ]
    },
    {
      "title": "Update SPP Settings",
      "operation": "update_service_protection_profile_settings",
      "description": "Updates the SPP settings based on the SPP name, resource name, and resource arguments you have specified.",
      "category": "remediation",
      "annotation": "update_service_protection_profile_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "SPP Name",
          "type": "text",
          "name": "spp",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "SPP-0",
          "tooltip": "Name of the service protection profile",
          "description": "Specify the name of the SPP whose settings you want to update in FortiDDoS."
        },
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "SPP Settings",
          "options": [
            "SPP Settings",
            "Service Config",
            "Access Control List",
            "Address Config",
            "Address Config IPv6",
            "Extended Timeout Policy",
            "Thresholds > Thresholds > Scalars",
            "Thresholds > Thresholds > HTTP Methods",
            "Thresholds > Thresholds > Protocols",
            "Thresholds > Thresholds > TCP Ports",
            "Thresholds > Thresholds > UDP Ports",
            "Thresholds > Thresholds > ICMP Types/Codes",
            "Thresholds > Thresholds > URLs",
            "Thresholds > Thresholds > Hosts",
            "Thresholds > Thresholds > Referers",
            "Thresholds > Thresholds > Cookies",
            "Thresholds > Thresholds > User Agents"
          ],
          "description": "Select the name of the resource whose settings you want to update in FortiDDoS. You can choose the following options: SPP Settings, Service Config, Access Control List, Address Config, Address Config IPv6, Extended Timeout Policy, Thresholds > Thresholds > Scalars, Thresholds > Thresholds > HTTP Methods, Thresholds > Thresholds > Protocols, Thresholds > Thresholds > TCP Ports, Thresholds > Thresholds > UDP Ports, Thresholds > Thresholds > ICMP Types/Codes, Thresholds > Thresholds > URLs, Thresholds > Thresholds > Hosts, Thresholds > Thresholds > Referers, Thresholds > Thresholds > Cookies, Thresholds > Thresholds > User Agents."
        },
        {
          "title": "Resource Arguments",
          "required": true,
          "visible": true,
          "editable": true,
          "type": "json",
          "name": "parameter_name_val",
          "tooltip": "Resource arguments in json format",
          "placeholder": "{\"field1\":value1, \"field2\":value2}",
          "value": {
            "inbound-operating-mode": "prevention"
          },
          "description": "Specify the setting arguments that you want to update for the specified SPP. You can enter the arguments in JSON format. For example, {\"field1\":value1, \"field2\":value2}. Eg: {\"inbound-operating-mode\":  \"prevention\"}"
        }
      ],
      "output_schema": {
        "status": "",
        "message": ""
      }
    },
    {
      "title": "Get Global Settings",
      "operation": "get_global_settings",
      "description": "Retrieves all global settings from the FortiDDoS appliance. The global settings are located at: Global Settings > Settings > Settings.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [],
      "output_schema": {
        "query": "",
        "success": "",
        "message": "",
        "data": [
          {
            "link-down-synchronization": "",
            "blocking-period": "",
            "source-blocking-period": "",
            "extended-blocking-period": "",
            "drop-threshold-within-blocking-period": "",
            "url-per-source-observation-period": "",
            "http-source-observation-period": "",
            "ip-v6-prefix-length": "",
            "source-mac-address-aggressive-aging": "",
            "http-anomaly": "",
            "geo-location": "",
            "ipv6-prefix": "",
            "http-partial-request-per-source-per-second-threshold": "",
            "http-partial-request-to-response-observation-period": "",
            "local-address-anti-spoofing": "",
            "asymmetric-mode": "",
            "asymmetric-mode-allow-inbound-synack": "",
            "tap-mode": "",
            "drop-http-range-header": "",
            "dns-response-size": "",
            "power-fail-bypass-mode": "",
            "signaling-mode": "",
            "invalid-icmp-anomaly": "",
            "spp-switching-threshold-measurement-unit": "",
            "persistent-http-transactions": "",
            "reboot-on-graceful-recovery": "",
            "drop-threshold-for-foreign-packets": "",
            "dpc-timeout": "",
            "gtp-protocol-inspection": "",
            "lq-apply-schedule": "",
            "lq-drop-threshold": ""
          }
        ]
      }
    },
    {
      "title": "Get Global Service Protection Profiles",
      "operation": "get_global_spp",
      "description": "Retrieves the global service protection profile from the FortiDDoS appliance based on the resource name you have specified. The global service protection profiles are located at: Global Settings > Service Protection Profiles.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "Switching Policy",
          "tooltip": "Global Settings > Service Protection Profiles",
          "options": [
            "Switching Policy",
            "SPP Policy",
            "SPP Policy Group"
          ],
          "description": "Select the name of the resource whose global service protection profile information you want to retrieve from FortiDDoS. You can choose from the following options: \"Switching Policy\", \"SPP Policy\", \"SPP Policy Group\"."
        }
      ],
      "conditional_output_schema": [
        {
          "condition": "{{this['resource_name'] === 'SPP Policy Group'}}",
          "output_schema": {
            "success": "",
            "query": "",
            "data": [
              {
                "mkey": "",
                "member-list": ""
              }
            ],
            "message": ""
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Switching Policy'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "enable-switching": "",
                "timeout": "",
                "start-timeout": "",
                "switching-type": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'SPP Policy'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "spp": "",
                "mkey": "",
                "alt-spp": "",
                "comment": "",
                "subnet-id": "",
                "threshold": "",
                "ip-version": "",
                "ip-addr-mask": "",
                "alt-spp-enable": "",
                "threshold-mbps": "",
                "ipv6-addr-prefix": "",
                "threshold-per-million": ""
              }
            ]
          }
        }
      ]
    },
    {
      "title": "Get Settings",
      "operation": "get_settings",
      "description": "Retrieves the internal sub-resources from settings in the FortiDDoS global settings based on the resource name you have specified. The global settings are located at: Global Settings > Settings.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "tooltip": "Global Settings > Settings",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "HTTP Service Ports",
          "options": [
            "HTTP Service Ports",
            "UDP Service Ports",
            "Signaling",
            "GRE Tunnel Endpoint"
          ],
          "description": "Select the name of the resource whose internal sub-resources you want to retrieve from settings in FortiDDoS. You can choose from the following options: HTTP Service Ports, UDP Service Ports, Signaling, GRE Tunnel Endpoint."
        }
      ],
      "output_schema": {
        "success": "",
        "query": "",
        "data": [],
        "message": ""
      }
    },
    {
      "title": "Get Global Settings Address",
      "operation": "get_global_settings_address",
      "description": "Retrieves the global setting address of the FortiDDoS appliance based on the resource name you have specified.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "Address Config",
          "tooltip": "Global Settings > Address",
          "options": [
            "Local Address Config",
            "Local Address Config IPv6",
            "Address Config",
            "Address Config IPv6"
          ],
          "description": "Select the name of the resource whose global setting address information you want to retrieve from settings in FortiDDoS. You can choose from the following options: Local Address Config, Local Address Config IPv6, Address Config, Address Config IPv6."
        }
      ],
      "conditional_output_schema": [
        {
          "condition": "{{this['resource_name'] === 'Local Address Config'}}",
          "output_schema": {
            "success": "",
            "query": "",
            "data": [
              {
                "mkey": "",
                "ip-netmask": ""
              }
            ],
            "message": ""
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Local Address Config IPv6'}}",
          "output_schema": {
            "success": "",
            "query": "",
            "data": [
              {
                "mkey": "",
                "ip-prefix": ""
              }
            ],
            "message": ""
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Address Config'}}",
          "output_schema": {
            "success": "",
            "query": "",
            "data": [
              {
                "mkey": "",
                "type": "",
                "ip-netmask": "",
                "ip-address": "",
                "geo-location": ""
              }
            ],
            "message": ""
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Address Config IPv6'}}",
          "output_schema": {
            "success": "",
            "query": "",
            "data": [
              {
                "mkey": "",
                "type": "",
                "ipv6-addr-prefix": "",
                "ipv6-address": ""
              }
            ],
            "message": ""
          }
        }
      ]
    },
    {
      "title": "Get IP Reputation",
      "operation": "get_ip_reputation",
      "description": "Retrieves the IP reputation details of the FortiDDoS appliance. The IP reputation details are located at: Global Settings > IP Reputation.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [],
      "output_schema": {
        "success": "",
        "query": "",
        "data": [
          {
            "ip-reputation-status": "",
            "override-server-ip": "",
            "ip-reputation-ip-address": "",
            "ip-reputation-schedule-type": "",
            "ip-reputation-schedule-hour": "",
            "ip-reputation-schedule-weekday": "",
            "ip-reputation-category": "",
            "ip-reputation-tunnel": "",
            "ip-reputation-tunnel-address": "",
            "ip-reputation-tunnel-port": "",
            "ip-reputation-tunnel-user": "",
            "ip-reputation-tunnel-password": ""
          }
        ],
        "message": ""
      }
    },
    {
      "title": "Get Domain Reputation",
      "operation": "get_domain_reputation",
      "description": "Retrieves the domain reputation details of the FortiDDoS appliance. The IP reputation details are located at: Global Settings > Domain Reputation.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [],
      "output_schema": {
        "query": "",
        "success": "",
        "message": "",
        "data": [
          {
            "domain-reputation-status": "",
            "override-server-ip": "",
            "domain-reputation-ip-address": "",
            "domain-reputation-schedule-type": ""
          }
        ]
      }
    },
    {
      "title": "Get Proxy IP",
      "operation": "get_proxy_ip",
      "description": "Retrieves the proxy IP details of the FortiDDoS appliance.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [],
      "output_schema": {
        "query": "",
        "success": "",
        "message": "",
        "data": [
          {
            "auto-proxy-ip-status": "",
            "header-proxy-ip-status": "",
            "header-proxy-type": "",
            "concurrent-connections-per-source": "",
            "proxy-ip-threshold-factor": "",
            "proxy-ip-percent-present": "",
            "observation-period": "",
            "download-list": "",
            "backup-status": ""
          }
        ]
      }
    },
    {
      "title": "Get Proxy IP Policy",
      "operation": "get_proxy_ip_policy",
      "description": "Retrieves the proxy IP policy details of the FortiDDoS appliance.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [],
      "output_schema": {
        "query": "",
        "success": "",
        "message": "",
        "data": []
      }
    },
    {
      "title": "Get Do Not Track Policy",
      "operation": "get_do_not_track_policy",
      "description": "Retrieves the 'do not track policy' settings of the FortiDDoS appliance based on the resource name you have specified.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "Do Not Track Policy",
          "options": [
            "Do Not Track Policy",
            "Do Not Track Policy IPv6"
          ],
          "description": "Select the name of the resource whose 'do not track policy' settings you want to retrieve from FortiDDoS. You can choose from the following options: Do Not Track Policy, Do Not Track Policy IPv6"
        }
      ],
      "output_schema": {
        "success": "",
        "query": "",
        "data": [
          {
            "mkey": "",
            "source-address": "",
            "do-not-track-action": ""
          }
        ],
        "message": ""
      }
    },
    {
      "title": "Get Access Control List",
      "operation": "get_global_acl",
      "description": "Retrieves the access control list details of global settings from the FortiDDoS appliance.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": true,
          "editable": true,
          "tooltip": "Global Settings > Access Control List",
          "value": "Access Control List",
          "options": [
            "Access Control List",
            "Access Control List IPv6",
            "Advanced Settings: Distress ACL"
          ],
          "description": "Select the name of the resource whose access control list details you want to retrieve from global settings in FortiDDoS. You can choose from the following options: Access Control List, Access Control List IPv6, Advanced Settings: Distress ACL."
        }
      ],
      "conditional_output_schema": [
        {
          "condition": "{{this['resource_name'] === 'Access Control List' || this['resource_name'] === 'Access Control List IPv6'}}",
          "output_schema": {
            "success": "",
            "query": "",
            "data": [
              {
                "mkey": "",
                "action": "",
                "source-address": ""
              }
            ],
            "message": ""
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Advanced Settings: Distress ACL'}}",
          "output_schema": [
            {
              "mkey": "",
              "acl-enable": "",
              "rrd-entry": "",
              "fragment": "",
              "fragment-type": "",
              "tcp-control-flag": "",
              "tcp-control-flag-options": "",
              "ttl": "",
              "ttl-value": "",
              "dscp": "",
              "dscp-value": "",
              "protocol": "",
              "protocol-number": "",
              "icmp": "",
              "icmp-type": "",
              "icmp-code": "",
              "source-ip": "",
              "source-ipv4-netmask": "",
              "destination": "",
              "destination-ipv4-netmask": "",
              "destination-subnet": "",
              "destination-spp": "",
              "source-port": "",
              "source-port-start": "",
              "source-port-end": "",
              "destination-port": "",
              "destination-port-start": "",
              "destination-port-end": "",
              "system-generated": ""
            }
          ]
        }
      ]
    },
    {
      "title": "Get Bypass MAC",
      "operation": "get_bypass_mac",
      "description": "Retrieves the bypass MAC details of the FortiDDoS appliance.",
      "category": "investigation",
      "annotation": "get_global_settings",
      "enabled": true,
      "parameters": [],
      "output_schema": {
        "query": "",
        "success": "",
        "message": "",
        "data": [
          {
            "mkey": "",
            "mac-address": ""
          }
        ]
      }
    },
    {
      "title": "Get System Settings",
      "operation": "get_system_settings",
      "description": "Retrieves the system settings information from FortiDDoS based on the resource name you have specified.",
      "category": "investigation",
      "annotation": "get_system_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Primary Resource Name",
          "type": "select",
          "name": "primary_resource_name",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "Interface",
          "options": [
            "Network",
            "High Availability",
            "Admin",
            "Authentication",
            "SNMP",
            "Certificate"
          ],
          "onchange": {
            "Network": [
              {
                "title": "Resource Name",
                "type": "select",
                "name": "resource_name",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "Interface",
                "options": [
                  "Interface",
                  "DNS",
                  "Static Route"
                ],
                "description": "Select the name of the resource whose system settings you want to retrieve from FortiDDoS. You can choose from the following options: Interface, DNS, or Static Route."
              }
            ],
            "Admin": [
              {
                "title": "Resource Name",
                "type": "select",
                "name": "resource_name",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "Settings",
                "options": [
                  "Admin User",
                  "Access Profile",
                  "Settings"
                ],
                "description": "Select the name of the resource whose system settings you want to retrieve from FortiDDoS. You can choose from the following options: Admin User, Access Profile, or Settings."
              }
            ],
            "Authentication": [
              {
                "title": "Resource Name",
                "type": "select",
                "name": "resource_name",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "Auth Radius",
                "options": [
                  "Auth Radius",
                  "Auth LDAP",
                  "Auth TACACS+"
                ],
                "description": "Select the name of the resource whose system settings you want to retrieve from FortiDDoS. You can choose from the following options: Auth Radius, Auth LDAP, Auth TACACS+"
              }
            ],
            "SNMP": [
              {
                "title": "Resource Name",
                "type": "select",
                "name": "resource_name",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "System Information",
                "tooltip": "System > SNMP",
                "options": [
                  "System Information",
                  "SNMP Threshold",
                  "Community"
                ],
                "description": "Select the name of the resource whose system settings you want to retrieve from FortiDDoS. You can choose from the following options: System Information, SNMP Threshold, Community."
              }
            ]
          },
          "description": "Select the name of the primary resource whose system settings you want to retrieve from FortiDDoS. You can choose from the following options: Network, High Availability, Admin, Authentication, SNMP, Certificate. If you select 'High Availability' or 'Certificate', then you do not need to specify any additional parameters; for the other options, specify the parameters that are required."
        }
      ],
      "conditional_output_schema": [
        {
          "condition": "{{this['resource_name'] === 'Auth LDAP'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "dn": "",
                "cnid": "",
                "port": "",
                "state": "",
                "domain": "",
                "secure": "",
                "server": "",
                "profile": "",
                "password": "",
                "username": "",
                "bind-type": "",
                "is-spp-admin": "",
                "trusted-host": "",
                "is-system-admin": "",
                "default-spp-policy-group": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Auth Radius' || this['resource_name'] === 'Auth TACACS+'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "port": "",
                "state": "",
                "domain": "",
                "nas_ip": "",
                "secret": "",
                "server": "",
                "profile": "",
                "auth_prot": "",
                "is-spp-admin": "",
                "trusted-host": "",
                "backup-secret": "",
                "backup-server": "",
                "is-system-admin": "",
                "default-spp_policy-group": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'SNMP Threshold'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "cpu": "",
                "mem": "",
                "logdisk": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'System Information'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "status": "",
                "contact": "",
                "location": "",
                "engine-id": "",
                "description": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Community'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "mkey": "",
                "name": "",
                "hosts": [],
                "events": "",
                "status": "",
                "hosts_count": "",
                "query_v1_port": "",
                "query_v2c_port": "",
                "restrict_hosts": "",
                "trap_v1_status": "",
                "query_v1_status": "",
                "trap_v2c_status": "",
                "query_v2c_status": "",
                "trap_v1_local_port": "",
                "trap_v1_remote_port": "",
                "trap_v2c_local_port": "",
                "trap_v2c_remote_port": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Interface'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "ip": "",
                "ip6": "",
                "mkey": "",
                "type": "",
                "speed": "",
                "expand": "",
                "status": "",
                "allowaccess": "",
                "logical-name": "",
                "asymmetric-mirror": "",
                "dropped-packet-capture": "",
                "forward-error-correction": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'DNS'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "ip_second": "",
                "ip_primary": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Static Route'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "gw": "",
                "dest": "",
                "mkey": "",
                "status": "",
                "interface": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['primary_resource_name'] === 'High Availability'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "mode": "",
                "port": "",
                "arp_num": "",
                "groupid": "",
                "interval": "",
                "override": "",
                "priority": "",
                "group-name": "",
                "arp_interval": "",
                "interface_list": "",
                "hb-lost-threshold": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Settings'}}",
          "output_schema": {
            "data": [
              {
                "hostname": "",
                "ssh-port": "",
                "http-port": "",
                "https-port": "",
                "telnet-port": "",
                "tls-version-1.1": "",
                "tls-version-1.2": "",
                "tls-version-1.3": "",
                "remoteauthtimeout": "",
                "admin-idle-timeout": "",
                "sys-global-language": "",
                "private-data-encryption": "",
                "https-server-certificate": "",
                "private-data-encryption-key": ""
              }
            ],
            "query": "",
            "message": "",
            "success": ""
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Admin User'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "mkey": "",
                "theme": "",
                "api-id": "",
                "domain": "",
                "hidden": "",
                "passwd": "",
                "profile": "",
                "strategy": "",
                "is-spp-admin": "",
                "trusted-host": "",
                "is-system-admin": "",
                "allow-api-access": "",
                "spp-policy-group": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'Access Profile'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "log": "",
                "mkey": "",
                "system": "",
                "monitor": "",
                "global-settings": "",
                "protection-profiles": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['primary_resource_name'] === 'Certificate'}}",
          "output_schema": {
            "data": [
              {
                "sn": "",
                "mkey": "",
                "issuer": "",
                "passwd": "",
                "status": "",
                "subject": "",
                "validto": "",
                "comments": "",
                "version": "",
                "extension": "",
                "validfrom": ""
              }
            ],
            "query": "",
            "message": "",
            "success": ""
          }
        }
      ]
    },
    {
      "title": "Get Log Settings",
      "operation": "get_log_settings",
      "description": "Retrieves log information from the FortiDDoS appliance based on the resource name you have specified.",
      "category": "investigation",
      "annotation": "get_log_settings",
      "enabled": true,
      "parameters": [
        {
          "title": "Resource Name",
          "type": "select",
          "name": "resource_name",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "log_local",
          "options": [
            "log_local",
            "log_remote",
            "log_setting_ddos_attack_remote",
            "ddos_global_attack_event_purge",
            "log_setting_snmp_trap_receivers",
            "log_report",
            "ddos_global_attack_report_purge",
            "log_setting_remote_log_settings",
            "alertemail_recipient",
            "alertemail_server",
            "alertemail_setting"
          ],
          "description": "Select the name of the resource whose log settings you want to retrieve from FortiDDoS. You can choose from the following options: log_local, log_remote, log_setting_ddos_attack_remote, ddos_global_attack_event_purge, log_setting_snmp_trap_receivers, log_report, ddos_global_attack_report_purge, log_setting_remote_log_settings, alertemail_recipient, alertemail_server, alertemail_setting"
        }
      ],
      "conditional_output_schema": [
        {
          "condition": "{{true}}",
          "output_schema": {
            "data": [],
            "query": "",
            "success": "",
            "message": ""
          }
        },
        {
          "condition": "{{this['resource_name'] === 'log_local'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "event": "",
                "status": "",
                "diskfull": "",
                "filesize": "",
                "loglevel": "",
                "event_category": ""
              }
            ]
          }
        },
        {
          "condition": "{{this['resource_name'] === 'ddos_global_attack_report_purge'}}",
          "output_schema": {
            "query": "",
            "success": "",
            "message": "",
            "data": [
              {
                "purge-end-date": "",
                "purge-watermark": "",
                "purge-start-date": "",
                "manual-event-purge": "",
                "automatic-event-purge": ""
              }
            ]
          }
        }
      ]
    },
    {
      "title": "Get Attack Information",
      "operation": "get_attack_information",
      "description": "Retrieves attack information from FortiDDoS based on the SPP name, attack subtype, direction, and period you have specified.",
      "category": "investigation",
      "annotation": "get_attack_information",
      "enabled": true,
      "parameters": [
        {
          "title": "SPP",
          "type": "text",
          "name": "spp_name",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "SPP-0",
          "tooltip": "Name of the service protection profile",
          "description": "Specify the name of the Service Protection Profile (SPP) whose attack information you want to retrieve from FortiDDoS."
        },
        {
          "title": "Subtype",
          "type": "select",
          "name": "subtype",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "top_attacks",
          "options": [
            "top_attacks",
            "top_attackers",
            "top_acl_attacks",
            "top_attacked_spps",
            "top_attacked_acl_spps",
            "top_attacked_subnets",
            "top_acl_subnets",
            "top_attacked_destinations",
            "top_attacked_protocols",
            "top_attacked_tcp_ports",
            "top_attacked_udp_ports",
            "top_attacked_icmp_type_codes",
            "top_attacked_http_methods",
            "top_attacked_http_cookies",
            "top_attacked_http_referers",
            "top_attacked_http_user_agents",
            "top_attacked_http_hosts",
            "top_attacked_http_urls",
            "top_attacked_dns_servers",
            "top_attacked_dns_anomalies"
          ],
          "description": "Select the name of the subtype for which you want to retrieve attack information from FortiDDoS. You can choose the following options: top_attacks, top_attackers, top_acl_attacks, top_attacked_spps, top_attacked_acl_spps, top_attacked_subnets, top_acl_subnets, top_attacked_destinations, top_attacked_protocols, top_attacked_tcp_ports, top_attacked_udp_ports, top_attacked_icmp_type_codes, top_attacked_http_methods, top_attacked_http_cookies, top_attacked_http_referers, top_attacked_http_user_agents, top_attacked_http_hosts, top_attacked_http_urls, top_attacked_dns_servers, top_attacked_dns_anomalies. The attack information located at: Log & Report > Executive Summary > DDoS Attack Log."
        },
        {
          "title": "Direction",
          "type": "select",
          "name": "dir",
          "required": false,
          "visible": true,
          "editable": true,
          "value": "Inbound",
          "options": [
            "Inbound",
            "Outbound"
          ],
          "description": "Select the direction to retrieve attack information from FortiDDoS. You can choose between Inbound or Outbound."
        },
        {
          "title": "Period",
          "type": "select",
          "name": "period",
          "required": false,
          "visible": true,
          "editable": true,
          "value": "1 year",
          "options": [
            "1 hour",
            "8 hours",
            "1 day",
            "1 week",
            "1 month",
            "1 year"
          ],
          "description": "Specify the period to retrieve attack information from FortiDDoS. You can choose between 1 hour, 8 hours, 1 day, 1 week, 1 month, or 1 year."
        }
      ],
      "conditional_output_schema": [
        {
          "condition": "{{true}}",
          "output_schema": {
            "data": [],
            "total": "",
            "success": "",
            "message": ""
          }
        },
        {
          "condition": "{{this['subtype'] === 'top_attackers' || this['subtype'] === 'top_attacked_destinations'}}",
          "output_schema": {
            "data": [
              {
                "IP": "",
                "SPP": "",
                "Direction": "",
                "Events": "",
                "Drops": "",
                "spp-id": ""
              }
            ],
            "total": "",
            "success": "",
            "message": ""
          }
        },
        {
          "condition": "{{this['subtype'] === 'top_attacked_tcp_ports' || this['subtype'] === 'top_attacked_udp_ports'}}",
          "output_schema": {
            "data": [
              {
                "Port": "",
                "SPP": "",
                "Direction": "",
                "Events": "",
                "Drops": "",
                "spp-id": ""
              }
            ],
            "total": "",
            "success": "",
            "message": ""
          }
        },
        {
          "condition": "{{this['subtype'] === 'top_attacked_icmp_type_codes'}}",
          "output_schema": {
            "data": [
              {
                "Type:Code": "",
                "SPP": "",
                "Direction": "",
                "Events": "",
                "Drops": "",
                "spp-id": ""
              }
            ],
            "total": "",
            "success": "",
            "message": ""
          }
        },
        {
          "condition": "{{this['subtype'] === 'top_attacks'}}",
          "output_schema": {
            "data": [
              {
                "SPP": "",
                "Drops": "",
                "Attack": "",
                "Events": "",
                "spp-id": "",
                "Direction": ""
              }
            ],
            "total": "",
            "success": "",
            "message": ""
          }
        },
        {
          "condition": "{{this['subtype'] === 'top_attacked_dns_servers' || this['subtype'] === 'top_attacked_dns_anomalies'}}",
          "output_schema": {}
        }
      ]
    },
    {
      "title": "Add Distress ACL",
      "operation": "add_distress_acl",
      "description": "Adds a new Distress ACL to the FortiDDoS appliance based on the Mkey, destination, and other input parameters you have specified.",
      "category": "remediation",
      "annotation": "add_distress_acl",
      "enabled": true,
      "parameters": [
        {
          "title": "MKey",
          "type": "text",
          "name": "mkey",
          "required": true,
          "visible": true,
          "editable": true,
          "description": "Specify the MKey name to add the new distress ACL to the FortiDDoS appliance."
        },
        {
          "title": "ACL Enable",
          "type": "checkbox",
          "name": "acl-enable",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "description": "Select the ACL Enable option if you want to enable the new Distress ACL that you are adding to the FortiDDoS appliance."
        },
        {
          "title": "Destination",
          "type": "select",
          "name": "destination",
          "required": true,
          "visible": true,
          "editable": true,
          "options": [
            "ip-netmask-ipv4",
            "all"
          ],
          "value": "all",
          "onchange": {
            "ip-netmask-ipv4": [
              {
                "title": "Destination IPv4 Netmask",
                "type": "text",
                "name": "destination-ipv4-netmask",
                "required": true,
                "visible": true,
                "editable": true,
                "placeholder": "eg. 0.0.0.0/0",
                "tooltip": "Example: 192.3.2.5/24",
                "description": "Specify the destination IPv4 Netmask to add to the new Distress ACL in the FortiDDoS. Example: 192.3.2.5/24"
              }
            ],
            "all": [
              {
                "title": "SPP Name",
                "type": "text",
                "name": "spp",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "SPP-0",
                "description": "Specify the SPP name to add to the new Distress ACL in the FortiDDoS."
              },
              {
                "title": "Destination IPv4 Netmask",
                "type": "text",
                "name": "destination-ipv4-netmask",
                "required": false,
                "visible": true,
                "editable": true,
                "value": "0.0.0.0/0",
                "tooltip": "Example: 192.3.2.5/24",
                "description": "Specify the destination IPv4 Netmask to add to the new Distress ACL in the FortiDDoS. Example: 192.3.2.5/24"
              }
            ]
          },
          "description": "Select the destination in which you want to add the new Distress ACL that you want to add in FortiDDoS. You can choose between ip-netmask-ipv4 or all."
        },
        {
          "title": "Destination Port",
          "type": "checkbox",
          "name": "destination-port",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "Destination Port Start",
                "type": "text",
                "name": "destination-port-start",
                "required": true,
                "visible": true,
                "editable": true,
                "tooltip": "Range: 0 - 65535",
                "description": "Specify the start of the destination port that you want to add to the new Distress ACL that you are adding to the FortiDDoS appliance. Range: 0 - 65535"
              },
              {
                "title": "Destination Port End",
                "type": "text",
                "name": "destination-port-end",
                "required": true,
                "visible": true,
                "editable": true,
                "tooltip": "Range: 0 - 65535",
                "description": "Specify the end of the destination port that you want to add to the new Distress ACL that you are adding to the FortiDDoS appliance. Range: 0 - 65535"
              }
            ],
            "false": [
              {
                "title": "Threshold Per Million",
                "type": "text",
                "name": "threshold-per-million",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "1000000",
                "tooltip": "Range: 1 - 1000000",
                "description": "Specify the threshold per million that you want to add to the new Distress ACL that you are adding to the FortiDDoS appliance. For example, 1000000 Range: 1 - 1000000"
              }
            ]
          },
          "description": "Select the Destination Port option if you want to add the destination port information to the new Distress ACL that you are adding to the FortiDDoS appliance."
        },
        {
          "title": "DSCP",
          "type": "checkbox",
          "name": "dscp",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "DSCP Value",
                "type": "text",
                "name": "dscp-value",
                "required": true,
                "visible": true,
                "editable": true,
                "tooltip": "ToS Value. Range: 0 - 255",
                "description": "Specify the DSCP(ToS) value that you want to add to the new Distress ACL that you are adding to the FortiDDoS appliance. Range: 0 - 255"
              }
            ]
          },
          "tooltip": "ToS",
          "description": "Select the DSCP(ToS) option if you want to add the DSCP value information to the new Distress ACL that you are adding to the FortiDDoS appliance."
        },
        {
          "title": "Fragment",
          "type": "checkbox",
          "name": "fragment",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "Fragment Type",
                "type": "select",
                "name": "fragment-type",
                "required": false,
                "visible": true,
                "editable": true,
                "value": null,
                "options": [
                  "first-fragment",
                  "non-fragment-or-first-fragment",
                  "not-first-fragment",
                  "any-fragment"
                ]
              }
            ]
          },
          "description": "select the fragment type that you want to add to the new Distress ACL that you are adding to the FortiDDoS appliance. You can choose from the following options: first-fragment, non-fragment or first-fragment, non-first-fragment, or any-fragment."
        },
        {
          "title": "Protocol",
          "type": "checkbox",
          "name": "protocol",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "Protocol Number",
                "type": "text",
                "name": "protocol-number",
                "required": true,
                "visible": true,
                "editable": true,
                "tooltip": "Range: 0 - 255",
                "description": "Specify the protocol number that you want to add to the new Distress ACL that you are adding to the FortiDDoS appliance. Range: 0 - 255"
              }
            ]
          },
          "description": "Select the Protocol option if you want to add the protocol number information to the new Distress ACL that you are adding to the FortiDDoS appliance."
        },
        {
          "title": "Source IP",
          "type": "checkbox",
          "name": "source-ip",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "Source IPv4 Netmask",
                "type": "text",
                "name": "source-ipv4-netmask",
                "required": true,
                "visible": true,
                "editable": true,
                "tooltip": "Example: 192.3.2.5/24",
                "description": "Specify the source IP ipv4 netmask information that you want to add to the new Distress ACL that you are adding to the FortiDDoS appliance. Example: 192.3.2.5/24"
              }
            ]
          },
          "description": "Select the Source IP option if you want to add the source IP information to the new Distress ACL that you are adding to the FortiDDoS appliance."
        },
        {
          "title": "Source Port",
          "type": "checkbox",
          "name": "source-port",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "Source Port Start",
                "type": "text",
                "name": "source-port-start",
                "required": true,
                "visible": true,
                "editable": true,
                "tooltip": "Range: 0 - 65535",
                "description": "Specify the start of the source port that you want to add to the new Distress ACL that you are adding to the FortiDDoS appliance. Range: 0 - 65535"
              },
              {
                "title": "Source Port End",
                "type": "text",
                "name": "source-port-end",
                "required": true,
                "visible": true,
                "editable": true,
                "tooltip": "Range: 0 - 65535",
                "description": "Specify the end of the source port that you want to add to the new Distress ACL that you are adding to the FortiDDoS appliance. Range: 0 - 65535"
              }
            ]
          },
          "description": "Select the Source Port option if you want to add the source port information to the new Distress ACL that you are adding to the FortiDDoS appliance. If you select this checkbox, then you must specify the following parameter: Source Port Start and Source Port End."
        },
        {
          "title": "TCP Control Flag",
          "type": "checkbox",
          "name": "tcp-control-flag",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "TCP Control Flag Options",
                "type": "text",
                "name": "tcp-control-flag-options",
                "required": false,
                "visible": true,
                "editable": true,
                "tooltip": "FIN SYN RST PSH ACK URG",
                "description": "Specify the TCP control flag options information that you want to add to the new Distress ACL that you are adding to the FortiDDoS appliance. You can specify values as: FIN SYN RST PSH ACK URG"
              }
            ]
          },
          "description": "Select the TCP Control Flag option if you want to add the TCP control flag information to the new Distress ACL that you are adding to the FortiDDoS appliance. If you select this checkbox, then you must specify the following parameter: TCP Control Flag Options."
        },
        {
          "title": "TTL",
          "type": "checkbox",
          "name": "ttl",
          "required": false,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "TTL Value",
                "type": "text",
                "name": "ttl-value",
                "required": true,
                "visible": true,
                "editable": true,
                "tooltip": "Range: 0 - 255",
                "description": "Specify the TTL value that you want to add to the new Distress ACL that you are adding to the FortiDDoS appliance. Range: 0 - 255"
              }
            ]
          },
          "description": "Select the TTL option if you want to add the TTL value information to the new Distress ACL that you are adding to the FortiDDoS appliance. If you select this checkbox, then you must specify the following parameter: TTL Value."
        }
      ],
      "output_schema": {
        "status": "",
        "message": ""
      }
    },
    {
      "title": "Delete Distress ACL",
      "operation": "delete_distress_acl",
      "description": "Deletes a specific Distress ACL from the FortiDDoS appliance based on the name of the distress ACL you have specified.",
      "category": "remediation",
      "annotation": "delete_distress_acl",
      "enabled": true,
      "parameters": [
        {
          "title": "Distress ACL Name",
          "description": "Specify the name of the distress ACL.",
          "type": "text",
          "name": "name",
          "required": true,
          "visible": true,
          "editable": true,
          "tooltip": "Specify the name of the distress ACL that you want to delete from the FortiDDoS appliance."
        }
      ],
      "output_schema": {
        "status": "",
        "message": ""
      }
    },
    {
      "title": "Add Service Protection Profile Policy",
      "operation": "add_service_protection_profile_policy",
      "description": "Adds a new SPP Policy to the FortiDDoS appliance based on subnet ID, Mkey name, IP version, and the input parameters you have specified. The new SPP policy details are located at: Global Settings > Service Protection Profiles > SPP Policy.",
      "category": "remediation",
      "annotation": "add_service_protection_profile_policy",
      "enabled": true,
      "parameters": [
        {
          "title": "SPP",
          "type": "text",
          "name": "spp",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "SPP-0",
          "tooltip": "Name of the service protection profile",
          "description": "Specify the name of the Service protection profile to add the new SPP policy to the FortiDDoS appliance."
        },
        {
          "title": "Subnet ID",
          "type": "text",
          "name": "subnet-id",
          "required": true,
          "visible": true,
          "editable": true,
          "tooltip": "Range: 1 - 2047",
          "description": "Specify the subnet ID to add the new SPP policy to the FortiDDoS appliance. Range: 1 - 2047"
        },
        {
          "title": "MKey Name",
          "type": "text",
          "name": "mkey",
          "required": true,
          "visible": true,
          "editable": true,
          "tooltip": "SPP Policy Name",
          "description": "Specify the name of the MKey (SPP Policy) to add the new SPP policy to the FortiDDoS appliance."
        },
        {
          "title": "IP Version",
          "type": "select",
          "name": "ip-version",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "IPv4",
          "options": [
            "IPv4",
            "IPv6"
          ],
          "onchange": {
            "IPv4": [
              {
                "title": "IPv4/Netmask",
                "type": "text",
                "name": "ip-addr-mask",
                "required": true,
                "visible": true,
                "editable": true,
                "tooltip": "Example: 192.3.2.5/24",
                "description": "Specify the IPv4/Netmask to add the new SPP policy to the FortiDDoS appliance. Example: 192.3.2.5/24"
              }
            ],
            "IPv6": [
              {
                "title": "IPv6/Prefix",
                "type": "text",
                "name": "ipv6-addr-prefix",
                "required": true,
                "visible": true,
                "editable": true,
                "tooltip": "Example: 2001:0db8:85a3:8a2e:0370::7334/64",
                "description": "Specify the IPv6/Prefix to add the new SPP policy to the FortiDDoS appliance. Example: 2001:0db8:85a3:8a2e:0370::7334/64"
              }
            ]
          },
          "description": "Select this IP version to add the new SPP policy to the FortiDDoS appliance. You can choose between IPv4 or IPv6."
        },
        {
          "title": "Alternate SPP Enable",
          "type": "checkbox",
          "name": "alt-spp-enable",
          "required": true,
          "visible": true,
          "editable": true,
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "Alternate SPP",
                "type": "text",
                "name": "alt-spp",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "SPP-0",
                "description": "Specify the alternate SPP to add to the new SPP that you are adding to the FortiDDoS appliance."
              },
              {
                "title": "Threshold Per Million",
                "type": "text",
                "name": "threshold-per-million",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "1000000",
                "tooltip": "Range: 1 - 1000000",
                "description": "Specify the threshold per million that you want to add to the new SPP that you are adding to the FortiDDoS appliance. Range: 1 - 1000000"
              }
            ],
            "false": [
              {
                "title": "Threshold Per Million",
                "type": "text",
                "name": "threshold-per-million",
                "required": true,
                "visible": true,
                "editable": true,
                "value": "1000000",
                "tooltip": "Range: 1 - 1000000",
                "description": "Specify threshold per million to add a new SPP policy in FortiDDoS. Range: 1 - 1000000"
              }
            ]
          },
          "description": "Select the Alternate SPP Enable option if you want to specify an alternate SPP to the new SPP policy you want to add to the FortiDDoS appliance to add a new SPP policy to the FortiDDoS. If you select this checkbox, then you must specify the following parameter: Alternate SPP and Threshold Per Million. If you do not select this checkbox, then you must specify the following parameter: Threshold Per Million. "
        },
        {
          "title": "Comment",
          "type": "text",
          "name": "comment",
          "required": false,
          "visible": true,
          "editable": true,
          "value": "Added via FortiSOAR",
          "description": "Specify the threshold per million that you want to add to the new SPP that you are adding to the FortiDDoS appliance."
        }
      ],
      "output_schema": {
        "status": "",
        "message": ""
      }
    },
    {
      "title": "Get Service Protection Profile Policy",
      "operation": "get_service_protection_profile_policy",
      "description": "Retrieves a list of all Service Protection Profile Policies from the FortiDDoS appliance.",
      "category": "investigation",
      "annotation": "get_service_protection_profile_policy",
      "enabled": true,
      "parameters": [],
      "output_schema": {
        "data": [
          {
            "mkey": "",
            "subnet-id": "",
            "ip-version": "",
            "ip-addr-mask": "",
            "ipv6-addr-prefix": "",
            "spp": "",
            "alt-spp-enable": "",
            "alt-spp": "",
            "threshold": "",
            "threshold-mbps": "",
            "threshold-per-million": "",
            "comment": ""
          }
        ],
        "query": "",
        "success": "",
        "message": ""
      }
    },
    {
      "title": "Delete Service Protection Profile Policy",
      "operation": "delete_service_protection_profile_policy",
      "description": "Deletes a specific Service Protection Profile Policy from the FortiDDoS appliance based on the name of the SPP policy you have specified.",
      "category": "remediation",
      "annotation": "delete_service_protection_profile_policy",
      "enabled": true,
      "parameters": [
        {
          "title": "SPP Policy Name",
          "description": "Specify the name of the SPP policy that you want to delete from the FortiDDoS appliance.",
          "type": "text",
          "name": "policy_name",
          "required": true,
          "visible": true,
          "editable": true
        }
      ],
      "output_schema": {
        "status": "",
        "message": ""
      }
    },
    {
      "title": "Add Legitimate DNS Query",
      "operation": "add_lq",
      "description": "Adds a new legitimate DNS Query to the FortiDDoS appliance based on the query, type, and other input parameters you have specified.",
      "category": "remediation",
      "annotation": "add_lq",
      "enabled": true,
      "output_schema": {
        "status": "",
        "message": ""
      },
      "parameters": [
        {
          "title": "Query",
          "type": "text",
          "name": "query",
          "required": true,
          "visible": true,
          "editable": true,
          "tooltip": "Specify the query to add the new Legitimate DNS Query into the FortiDDoS appliance.",
          "description": "Specify the query to add the new Legitimate DNS Query into the FortiDDoS appliance."
        },
        {
          "title": "Type",
          "type": "text",
          "name": "type",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "1",
          "tooltip": "Specify the type to add the new Legitimate DNS Query into the FortiDDoS appliance.",
          "description": "Specify the type to add the new Legitimate DNS Query into the FortiDDoS appliance."
        },
        {
          "title": "Class",
          "type": "text",
          "name": "class",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "1",
          "tooltip": "Specify the class to add a new Legitimate DNS Query into the FortiDDoS appliance.",
          "description": "Specify the class to add a new Legitimate DNS Query into the FortiDDoS appliance."
        }
      ]
    },
    {
      "title": "Delete Legitimate DNS Query",
      "operation": "delete_lq",
      "description": "Deletes a specific legitimate DNS query from the FortiDDoS appliance based on the domain, type, and class you have specified.",
      "category": "remediation",
      "annotation": "delete_lq",
      "enabled": true,
      "parameters": [
        {
          "title": "Domain",
          "description": "Specify the domain for which you want to delete a legitimate DNS query that is present in the FortiDDoS appliance.",
          "type": "text",
          "name": "query",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Type",
          "description": "Specify the type for which you want to delete a legitimate DNS query that is present in the FortiDDoS appliance.",
          "type": "text",
          "name": "type",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "1"
        },
        {
          "title": "Class",
          "type": "text",
          "name": "class",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "1",
          "description": "Specify the class for which you want to delete a legitimate DNS query that is present in the FortiDDoS appliance."
        }
      ],
      "output_schema": {
        "status": "",
        "message": ""
      }
    },
    {
      "title": "Generate BGP Flowspec",
      "operation": "generate_bgp_flowspec",
      "description": "Generate BGP flow specifications based on the vendor name, destination under attack, and threshold you have specified.",
      "category": "containment",
      "annotation": "generate_bgp_flowspec",
      "enabled": true,
      "parameters": [
        {
          "title": "Vendor",
          "description": "Select the vendor who is generating the BGP flow specifications. You can choose between Cisco or Juniper.",
          "type": "select",
          "name": "vendor",
          "required": true,
          "visible": true,
          "editable": true,
          "value": null,
          "options": [
            "Cisco",
            "Juniper"
          ]
        },
        {
          "title": "Destination",
          "description": "Specify the destination that is under attack for which you want to generate the BGP flow specifications.",
          "type": "text",
          "name": "destination",
          "required": true,
          "visible": true,
          "editable": true,
          "placeholder": "IPv4 Address"
        },
        {
          "title": "Threshold",
          "description": "Specify the threshold to generate BGP flow specifications.",
          "type": "integer",
          "name": "threshold",
          "required": true,
          "visible": true,
          "editable": true
        }
      ],
      "output_schema": ""
    }
  ]
}